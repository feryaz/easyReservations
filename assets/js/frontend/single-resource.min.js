jQuery(function(c){if(typeof er_single_resource_params==="undefined"){return false}var b=function(d,e){this.$target=d;this.$images=c(".easyreservations-resource-gallery__image",d);if(0===this.$images.length){this.$target.css("opacity",1);return}d.data("resource_gallery",this);this.flexslider_enabled=c.isFunction(c.fn.flexslider)&&er_single_resource_params.flexslider_enabled;this.zoom_enabled=c.isFunction(c.fn.zoom)&&er_single_resource_params.zoom_enabled;this.photoswipe_enabled=typeof PhotoSwipe!=="undefined"&&er_single_resource_params.photoswipe_enabled;if(e){this.flexslider_enabled=false===e.flexslider_enabled?false:this.flexslider_enabled;this.zoom_enabled=false===e.zoom_enabled?false:this.zoom_enabled;this.photoswipe_enabled=false===e.photoswipe_enabled?false:this.photoswipe_enabled}if(1===this.$images.length){this.flexslider_enabled=false}this.initFlexslider=this.initFlexslider.bind(this);this.initZoom=this.initZoom.bind(this);this.initZoomForTarget=this.initZoomForTarget.bind(this);this.initPhotoswipe=this.initPhotoswipe.bind(this);this.onResetSlidePosition=this.onResetSlidePosition.bind(this);this.getGalleryItems=this.getGalleryItems.bind(this);this.openPhotoswipe=this.openPhotoswipe.bind(this);if(this.flexslider_enabled){this.initFlexslider(e.flexslider);d.on("easyreservations_gallery_reset_slide_position",this.onResetSlidePosition)}else{this.$target.css("opacity",1)}if(this.zoom_enabled){this.initZoom();d.on("easyreservations_gallery_init_zoom",this.initZoom)}if(this.photoswipe_enabled){this.initPhotoswipe()}};b.prototype.initFlexslider=function(g){var d=this.$target,e=this;var f=c.extend({selector:".easyreservations-resource-gallery__wrapper > .easyreservations-resource-gallery__image",start:function(){d.css("opacity",1)},after:function(h){e.initZoomForTarget(e.$images.eq(h.currentSlide))}},g);d.flexslider(f);c(".easyreservations-resource-gallery__wrapper .easyreservations-resource-gallery__image:eq(0) .wp-post-image").one("load",function(){var h=c(this);if(h){setTimeout(function(){var i=h.closest(".easyreservations-resource-gallery__image").height();var j=h.closest(".flex-viewport");if(i&&j){j.height(i)}},100)}}).each(function(){if(this.complete){c(this).trigger("load")}})};b.prototype.initZoom=function(){this.initZoomForTarget(this.$images.first())};b.prototype.initZoomForTarget=function(g){if(!this.zoom_enabled){return false}var d=this.$target.width(),e=false;c(g).each(function(h,j){var i=c(j).find("img");if(i.data("large_image_width")>d){e=true;return false}});if(e){var f=c.extend({touch:false},er_single_resource_params.zoom_options);if("ontouchstart" in document.documentElement){f.on="click"}g.trigger("zoom.destroy");g.zoom(f);setTimeout(function(){if(g.find(":hover").length){g.trigger("mouseover")}},100)}};b.prototype.initPhotoswipe=function(){if(this.zoom_enabled&&this.$images.length>0){this.$target.prepend('<a href="#" class="easyreservations-resource-gallery__trigger">🔍</a>');this.$target.on("click",".easyreservations-resource-gallery__trigger",this.openPhotoswipe);this.$target.on("click",".easyreservations-resource-gallery__image a",function(d){d.preventDefault()});if(!this.flexslider_enabled){this.$target.on("click",".easyreservations-resource-gallery__image a",this.openPhotoswipe)}}else{this.$target.on("click",".easyreservations-resource-gallery__image a",this.openPhotoswipe)}};b.prototype.onResetSlidePosition=function(){this.$target.flexslider(0)};b.prototype.getGalleryItems=function(){var e=this.$images,d=[];if(e.length>0){e.each(function(h,j){var g=c(j).find("img");if(g.length){var m=g.attr("data-large_image"),l=g.attr("data-large_image_width"),f=g.attr("data-large_image_height"),k={src:m,w:l,h:f,title:g.attr("data-caption")?g.attr("data-caption"):g.attr("title")};d.push(k)}})}return d};b.prototype.openPhotoswipe=function(k){k.preventDefault();var h=c(".pswp")[0],f=this.getGalleryItems(),j=c(k.target),i;if(j.is(".easyreservations-resource-gallery__trigger")||j.is(".easyreservations-resource-gallery__trigger img")){i=this.$target.find(".flex-active-slide")}else{i=j.closest(".easyreservations-resource-gallery__image")}var g=c.extend({index:c(i).index(),addCaptionHTMLFn:function(e,l){if(!e.title){l.children[0].textContent="";return false}l.children[0].textContent=e.title;return true}},er_single_resource_params.photoswipe_options);var d=new PhotoSwipe(h,PhotoSwipeUI_Default,f,g);d.init()};c.fn.er_resource_gallery=function(d){new b(this,d||er_single_resource_params);return this};c(".easyreservations-resource-gallery").each(function(){c(this).trigger("er-resource-gallery-before-init",[this,er_single_resource_params]);c(this).er_resource_gallery(er_single_resource_params);c(this).trigger("er-resource-gallery-after-init",[this,er_single_resource_params])});var a=c(".entry-summary  select#resource");if(a.length>0){a.closest(".form-row").remove()}a=c(".entry-summary  #resource");if(a.length===0){c("<input>").attr({type:"hidden",id:"resource",name:"resource",value:er_single_resource_params.resource_id}).appendTo(".entry-summary form")}else{a.val(er_single_resource_params.resource_id)}});