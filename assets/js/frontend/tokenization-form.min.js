jQuery(function(a){var b=function(c){this.$target=c;this.$formWrap=c.closest(".payment_box");this.params=a.extend({},{is_registration_required:false,is_logged_in:false},er_tokenization_form_params);this.onDisplay=this.onDisplay.bind(this);this.hideForm=this.hideForm.bind(this);this.showForm=this.showForm.bind(this);this.showSaveNewCheckbox=this.showSaveNewCheckbox.bind(this);this.hideSaveNewCheckbox=this.hideSaveNewCheckbox.bind(this);this.$target.on("click change",":input.easyreservations-SavedPaymentMethods-tokenInput",{tokenizationForm:this},this.onTokenChange);a("input#createaccount").on("change",{tokenizationForm:this},this.onCreateAccountChange);this.onDisplay()};b.prototype.onDisplay=function(){if(0===a(":input.easyreservations-SavedPaymentMethods-tokenInput:checked",this.$target).length){a(":input.easyreservations-SavedPaymentMethods-tokenInput:last",this.$target).prop("checked",true)}if(0===this.$target.data("count")){a(".easyreservations-SavedPaymentMethods-new",this.$target).remove()}var c=0<a("input#createaccount").length,d=c&&a("input#createaccount").is(":checked");if(d||this.params.is_logged_in||this.params.is_registration_required){this.showSaveNewCheckbox()}else{this.hideSaveNewCheckbox()}a(":input.easyreservations-SavedPaymentMethods-tokenInput:checked",this.$target).trigger("change")};b.prototype.onTokenChange=function(c){if("new"===a(this).val()){c.data.tokenizationForm.showForm();c.data.tokenizationForm.showSaveNewCheckbox()}else{c.data.tokenizationForm.hideForm();c.data.tokenizationForm.hideSaveNewCheckbox()}};b.prototype.onCreateAccountChange=function(c){if(a(this).is(":checked")){c.data.tokenizationForm.showSaveNewCheckbox()}else{c.data.tokenizationForm.hideSaveNewCheckbox()}};b.prototype.hideForm=function(){a(".er-payment-form",this.$formWrap).hide()};b.prototype.showForm=function(){a(".er-payment-form",this.$formWrap).show()};b.prototype.showSaveNewCheckbox=function(){a(".easyreservations-SavedPaymentMethods-saveNew",this.$formWrap).show()};b.prototype.hideSaveNewCheckbox=function(){a(".easyreservations-SavedPaymentMethods-saveNew",this.$formWrap).hide()};a.fn.er_tokenization_form=function(c){new b(this,c);return this};a(document.body).on("updated_checkout er-credit-card-form-init",function(){var c=a("ul.easyreservations-SavedPaymentMethods");c.each(function(){a(this).er_tokenization_form()})})});