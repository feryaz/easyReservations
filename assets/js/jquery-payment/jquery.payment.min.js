jQuery(function(a){(function(){var b,k,e,j,m,p,t,s,i,n,u,g,v,x,l,r,d,q,w,z,h,f,y,o=[].slice,c=[].indexOf||function(C){for(var B=0,A=this.length;B<A;B++){if(B in this&&this[B]===C){return B}}return -1};a=window.jQuery||window.Zepto||window.$;a.payment={};a.payment.fn={};a.fn.payment=function(){var A,B;B=arguments[0],A=2<=arguments.length?o.call(arguments,1):[];return a.payment.fn[B].apply(this,A)};j=/(\d{1,4})/g;a.payment.cards=e=[{type:"maestro",patterns:[5018,502,503,506,56,58,639,6220,67],format:j,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:true},{type:"forbrugsforeningen",patterns:[600],format:j,length:[16],cvcLength:[3],luhn:true},{type:"dankort",patterns:[5019],format:j,length:[16],cvcLength:[3],luhn:true},{type:"visa",patterns:[4],format:j,length:[13,16],cvcLength:[3],luhn:true},{type:"mastercard",patterns:[51,52,53,54,55,22,23,24,25,26,27],format:j,length:[16],cvcLength:[3],luhn:true},{type:"amex",patterns:[34,37],format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:true},{type:"dinersclub",patterns:[30,36,38,39],format:/(\d{1,4})(\d{1,6})?(\d{1,4})?/,length:[14],cvcLength:[3],luhn:true},{type:"discover",patterns:[60,64,65,622],format:j,length:[16],cvcLength:[3],luhn:true},{type:"unionpay",patterns:[62,88],format:j,length:[16,17,18,19],cvcLength:[3],luhn:false},{type:"jcb",patterns:[35],format:j,length:[16],cvcLength:[3],luhn:true}];b=function(G){var C,A,H,E,D,I,B,F;G=(G+"").replace(/\D/g,"");for(E=0,I=e.length;E<I;E++){C=e[E];F=C.patterns;for(D=0,B=F.length;D<B;D++){H=F[D];A=H+"";if(G.substr(0,A.length)===A){return C}}}};k=function(C){var B,D,A;for(D=0,A=e.length;D<A;D++){B=e[D];if(B.type===C){return B}}};g=function(B){var G,F,E,C,D,A;E=true;C=0;F=(B+"").split("").reverse();for(D=0,A=F.length;D<A;D++){G=F[D];G=parseInt(G,10);if((E=!E)){G*=2}if(G>9){G-=9}C+=G}return C%10===0};u=function(A){var B;if((A.prop("selectionStart")!=null)&&A.prop("selectionStart")!==A.prop("selectionEnd")){return true}if((typeof document!=="undefined"&&document!==null?(B=document.selection)!=null?B.createRange:void 0:void 0)!=null){if(document.selection.createRange().text){return true}}return false};f=function(F,A){var C,I,E,D,H,B;try{I=A.prop("selectionStart")}catch(G){D=G;I=null}H=A.val();A.val(F);if(I!==null&&A.is(":focus")){if(I===H.length){I=F.length}if(H!==F){B=H.slice(I-1,+I+1||9000000000);C=F.slice(I-1,+I+1||9000000000);E=F[I];if(/\d/.test(E)&&B===(""+E+" ")&&C===(" "+E)){I=I+1}}A.prop("selectionStart",I);return A.prop("selectionEnd",I)}};d=function(D){var E,B,G,C,I,H,A,F;if(D==null){D=""}G="\uff10\uff11\uff12\uff13\uff14\uff15\uff16\uff17\uff18\uff19";C="0123456789";H="";E=D.split("");for(A=0,F=E.length;A<F;A++){B=E[A];I=G.indexOf(B);if(I>-1){B=C[I]}H+=B}return H};r=function(B){var A;A=a(B.currentTarget);return setTimeout(function(){var C;C=A.val();C=d(C);C=C.replace(/\D/g,"");return f(C,A)})};x=function(B){var A;A=a(B.currentTarget);return setTimeout(function(){var C;C=A.val();C=d(C);C=a.payment.formatCardNumber(C);return f(C,A)})};t=function(F){var A,B,H,D,C,G,E;H=String.fromCharCode(F.which);if(!/^\d+$/.test(H)){return}A=a(F.currentTarget);E=A.val();B=b(E+H);D=(E.replace(/\D/g,"")+H).length;G=16;if(B){G=B.length[B.length.length-1]}if(D>=G){return}if((A.prop("selectionStart")!=null)&&A.prop("selectionStart")!==E.length){return}if(B&&B.type==="amex"){C=/^(\d{4}|\d{4}\s\d{6})$/}else{C=/(?:^|\s)(\d{4})$/}if(C.test(E)){F.preventDefault();return setTimeout(function(){return A.val(E+" "+H)})}else{if(C.test(E+H)){F.preventDefault();return setTimeout(function(){return A.val(E+H+" ")})}}};m=function(C){var A,B;A=a(C.currentTarget);B=A.val();if(C.which!==8){return}if((A.prop("selectionStart")!=null)&&A.prop("selectionStart")!==B.length){return}if(/\d\s$/.test(B)){C.preventDefault();return setTimeout(function(){return A.val(B.replace(/\d\s$/,""))})}else{if(/\s\d?$/.test(B)){C.preventDefault();return setTimeout(function(){return A.val(B.replace(/\d$/,""))})}}};l=function(B){var A;A=a(B.currentTarget);return setTimeout(function(){var C;C=A.val();C=d(C);C=a.payment.formatExpiry(C);return f(C,A)})};s=function(B){var A,D,C;D=String.fromCharCode(B.which);if(!/^\d+$/.test(D)){return}A=a(B.currentTarget);C=A.val()+D;if(/^\d$/.test(C)&&(C!=="0"&&C!=="1")){B.preventDefault();return setTimeout(function(){return A.val("0"+C+" / ")})}else{if(/^\d\d$/.test(C)){B.preventDefault();return setTimeout(function(){var F,E;F=parseInt(C[0],10);E=parseInt(C[1],10);if(E>2&&F!==0){return A.val("0"+F+" / "+E)}else{return A.val(""+C+" / ")}})}}};i=function(B){var A,D,C;D=String.fromCharCode(B.which);if(!/^\d+$/.test(D)){return}A=a(B.currentTarget);C=A.val();if(/^\d\d$/.test(C)){return A.val(""+C+" / ")}};n=function(B){var A,D,C;C=String.fromCharCode(B.which);if(!(C==="/"||C===" ")){return}A=a(B.currentTarget);D=A.val();if(/^\d$/.test(D)&&D!=="0"){return A.val("0"+D+" / ")}};p=function(C){var A,B;A=a(C.currentTarget);B=A.val();if(C.which!==8){return}if((A.prop("selectionStart")!=null)&&A.prop("selectionStart")!==B.length){return}if(/\d\s\/\s$/.test(B)){C.preventDefault();return setTimeout(function(){return A.val(B.replace(/\d\s\/\s$/,""))})}};v=function(B){var A;A=a(B.currentTarget);return setTimeout(function(){var C;C=A.val();C=d(C);C=C.replace(/\D/g,"").slice(0,4);return f(C,A)})};h=function(B){var A;if(B.metaKey||B.ctrlKey){return true}if(B.which===32){return false}if(B.which===0){return true}if(B.which<33){return true}A=String.fromCharCode(B.which);return !!/[\d\s]/.test(A)};w=function(D){var A,B,E,C;A=a(D.currentTarget);E=String.fromCharCode(D.which);if(!/^\d+$/.test(E)){return}if(u(A)){return}C=(A.val()+E).replace(/\D/g,"");B=b(C);if(B){return C.length<=B.length[B.length.length-1]}else{return C.length<=16}};z=function(C){var A,D,B;A=a(C.currentTarget);D=String.fromCharCode(C.which);if(!/^\d+$/.test(D)){return}if(u(A)){return}B=A.val()+D;B=B.replace(/\D/g,"");if(B.length>6){return false}};q=function(B){var A,D,C;A=a(B.currentTarget);D=String.fromCharCode(B.which);if(!/^\d+$/.test(D)){return}if(u(A)){return}C=A.val()+D;return C.length<=4};y=function(E){var B,D,C,A,F;B=a(E.currentTarget);F=B.val();A=a.payment.cardType(F)||"unknown";if(!B.hasClass(A)){D=(function(){var I,H,G;G=[];for(I=0,H=e.length;I<H;I++){C=e[I];G.push(C.type)}return G})();B.removeClass("unknown");B.removeClass(D.join(" "));B.addClass(A);B.toggleClass("identified",A!=="unknown");return B.trigger("payment.cardType",A)}};a.payment.fn.formatCardCVC=function(){this.on("keypress",h);this.on("keypress",q);this.on("paste",v);this.on("change",v);this.on("input",v);return this};a.payment.fn.formatCardExpiry=function(){this.on("keypress",h);this.on("keypress",z);this.on("keypress",s);this.on("keypress",n);this.on("keypress",i);this.on("keydown",p);this.on("change",l);this.on("input",l);return this};a.payment.fn.formatCardNumber=function(){this.on("keypress",h);this.on("keypress",w);this.on("keypress",t);this.on("keydown",m);this.on("keyup",y);this.on("paste",x);this.on("change",x);this.on("input",x);this.on("input",y);return this};a.payment.fn.restrictNumeric=function(){this.on("keypress",h);this.on("paste",r);this.on("change",r);this.on("input",r);return this};a.payment.fn.cardExpiryVal=function(){return a.payment.cardExpiryVal(a(this).val())};a.payment.cardExpiryVal=function(D){var E,C,A,B;B=D.split(/[\s\/]+/,2),E=B[0],A=B[1];if((A!=null?A.length:void 0)===2&&/^\d+$/.test(A)){C=(new Date).getFullYear();C=C.toString().slice(0,2);A=C+A}E=parseInt(E,10);A=parseInt(A,10);return{month:E,year:A}};a.payment.validateCardNumber=function(B){var A,C;B=(B+"").replace(/\s+|-/g,"");if(!/^\d+$/.test(B)){return false}A=b(B);if(!A){return false}return(C=B.length,c.call(A.length,C)>=0)&&(A.luhn===false||g(B))};a.payment.validateCardExpiry=function(E,B){var C,A,D;if(typeof E==="object"&&"month" in E){D=E,E=D.month,B=D.year}if(!(E&&B)){return false}E=a.trim(E);B=a.trim(B);if(!/^\d+$/.test(E)){return false}if(!/^\d+$/.test(B)){return false}if(!((1<=E&&E<=12))){return false}if(B.length===2){if(B<70){B="20"+B}else{B="19"+B}}if(B.length!==4){return false}A=new Date(B,E);C=new Date;A.setMonth(A.getMonth()-1);A.setMonth(A.getMonth()+1,1);return A>C};a.payment.validateCardCVC=function(B,C){var A,D;B=a.trim(B);if(!/^\d+$/.test(B)){return false}A=k(C);if(A!=null){return D=B.length,c.call(A.cvcLength,D)>=0}else{return B.length>=3&&B.length<=4}};a.payment.cardType=function(A){var B;if(!A){return null}return((B=b(A))!=null?B.type:void 0)||null};a.payment.formatCardNumber=function(C){var B,A,E,D;C=C.replace(/\D/g,"");B=b(C);if(!B){return C}E=B.length[B.length.length-1];C=C.slice(0,E);if(B.format.global){return(D=C.match(B.format))!=null?D.join(" "):void 0}else{A=B.format.exec(C);if(A==null){return}A.shift();A=a.grep(A,function(F){return F});return A.join(" ")}};a.payment.formatExpiry=function(B){var D,E,A,C;E=B.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/);if(!E){return""}D=E[1]||"";A=E[2]||"";C=E[3]||"";if(C.length>0){A=" / "}else{if(A===" /"){D=D.substring(0,1);A=""}else{if(D.length===2||A.length>0){A=" / "}else{if(D.length===1&&(D!=="0"&&D!=="1")){D="0"+D;A=" / "}}}}return D+A+C}}).call(this)});