jQuery(function(c){window.erTracks=window.erTracks||{};window.erTracks.recordEvent=window.erTracks.recordEvent||function(){};var b={states:null,init:function(){this.states=JSON.parse(er_admin_meta_boxes_order_params.countries.replace(/&quot;/g,'"'));c(".js_field-country").selectWoo().change(this.change_country);c(".js_field-country").trigger("change",[true]);c(document.body).on("change","select.js_field-state",this.change_state);c("#easyreservations-order-actions input, #easyreservations-order-actions a").click(function(){window.onbeforeunload=""});c("a.edit_address").click(this.edit_address);c("a.load_customer").on("click",this.load_address);c("#customer_user").on("change",this.change_customer_user)},change_country:function(k,n){if(typeof n==="undefined"){n=false}if(b.states===null){return}const m=c(this),g=m.val(),d=m.parents("div.edit_address").find(":input.js_field-state"),h=d.parent(),i=d.val(),l=d.attr("name"),q=d.attr("id"),p=m.data("easyreservations.stickState-"+g)?m.data("easyreservations.stickState-"+g):i,o=d.attr("placeholder");let $newstate;if(n){m.data("easyreservations.stickState-"+g,p)}h.show().find(".select2-container").remove();if(!c.isEmptyObject(b.states[g])){const f=b.states[g],j=c('<option value=""></option>').text(er_admin_meta_boxes_order_params.i18n_select_state_text);$newstate=c("<select></select>").prop("id",q).prop("name",l).prop("placeholder",o).addClass("js_field-state select short").append(j);c.each(f,function(e){const r=c("<option></option>").prop("value",e).text(f[e]);if(e===i){r.prop("selected")}$newstate.append(r)});$newstate.val(p);d.replaceWith($newstate);$newstate.show().selectWoo().hide().change()}else{$newstate=c('<input type="text" />').prop("id",q).prop("name",l).prop("placeholder",o).addClass("js_field-state").val(i);d.replaceWith($newstate)}c(document.body).trigger("country-change.easyreservations",[g,c(this).closest("div")])},change_state:function(){const f=c(this),e=f.val(),d=f.parents("div.edit_address").find(":input.js_field-country"),g=d.val();d.data("easyreservations.stickState-"+g,e)},edit_address:function(i){i.preventDefault();const h=c(this),f=h.closest(".order_data_column"),k=f.find("div.edit_address"),j=f.find("div.address"),g=k.find(".js_field-country"),d=k.find(".js_field-state");j.hide();h.parent().find("a").toggle();if(!g.val()){g.val(er_admin_meta_boxes_order_params.default_country).change();d.val(er_admin_meta_boxes_order_params.default_state).change()}k.show();window.erTracks.recordEvent("order_edit_address_click",{order_id:easyreservations_admin_meta_boxes.post_id,status:c("#order_status").val()})},change_customer_user:function(){if(!c("#_billing_country").val()){c("a.edit_address").click();b.load_address(true)}},load_address:function(f){if(true===f||window.confirm(easyreservations_admin_meta_boxes.load_address)){const d=c("#customer_user").val();if(!d){window.alert(easyreservations_admin_meta_boxes.no_customer_selected);return false}const e={user_id:d,action:"easyreservations_get_customer_details",security:easyreservations_admin_meta_boxes.get_customer_details_nonce};c("div.edit_address").block({message:null,overlayCSS:{background:"#fff",opacity:0.6}});c.ajax({url:easyreservations_admin_meta_boxes.ajax_url,data:e,type:"POST",success:function(g){if(g&&g.billing){c.each(g.billing,function(h,i){c(":input#_"+h).val(i).change()})}c("div.edit_address").unblock()}})}return false}};const a={init:function(){c("#easyreservations-order-notes").on("click","button.add_note",this.add_order_note).on("click","a.delete_note",this.delete_order_note)},add_order_note:function(){if(!c("textarea#add_order_note").val()){return}c("#easyreservations-order-notes").block({message:null,overlayCSS:{background:"#fff",opacity:0.6}});const d={action:"easyreservations_add_order_note",post_id:easyreservations_admin_meta_boxes.post_id,note:c("textarea#add_order_note").val(),note_type:c("select#order_note_type").val(),security:easyreservations_admin_meta_boxes.add_order_note_nonce};c.post(easyreservations_admin_meta_boxes.ajax_url,d,function(e){c("ul.order_notes .no-items").remove();c("ul.order_notes").prepend(e);c("#easyreservations-order-notes").unblock();c("#add_order_note").val("");window.erTracks.recordEvent("order_edit_add_order_note",{order_id:d.post_id,note_type:d.note_type||"private",status:c("#order_status").val()})});return false},delete_order_note:function(){if(window.confirm(easyreservations_admin_meta_boxes.i18n_delete_note)){const d=c(this).closest("li.note");c(d).block({message:null,overlayCSS:{background:"#fff",opacity:0.6}});const e={action:"easyreservations_delete_order_note",note_id:c(d).attr("rel"),security:easyreservations_admin_meta_boxes.delete_order_note_nonce};c.post(easyreservations_admin_meta_boxes.ajax_url,e,function(){c(d).remove()})}return false}};b.init();a.init()});