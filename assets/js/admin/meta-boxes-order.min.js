jQuery(function(c){var b={states:null,init:function(){if(!(typeof easyreservations_admin_meta_boxes_order==="undefined"||typeof easyreservations_admin_meta_boxes_order.countries==="undefined")){this.states=c.parseJSON(easyreservations_admin_meta_boxes_order.countries.replace(/&quot;/g,'"'))}c(".js_field-country").selectWoo().change(this.change_country);c(".js_field-country").trigger("change",[true]);c(document.body).on("change","select.js_field-state",this.change_state);c("#easyreservations-order-actions input, #easyreservations-order-actions a").click(function(){window.onbeforeunload=""});c("a.edit_address").click(this.edit_address);c("a.load_customer").on("click",this.load_address);c("#customer_user").on("change",this.change_customer_user)},change_country:function(n,p){if(typeof p==="undefined"){p=false}if(b.states===null){return}var o=c(this),g=o.val(),d=o.parents("div.edit_address").find(":input.js_field-state"),i=d.parent(),j=d.val(),l=d.attr("name"),m=d.attr("id"),r=o.data("easyreservations.stickState-"+g)?o.data("easyreservations.stickState-"+g):j,q=d.attr("placeholder"),h;if(p){o.data("easyreservations.stickState-"+g,r)}i.show().find(".select2-container").remove();if(!c.isEmptyObject(b.states[g])){var f=b.states[g],k=c('<option value=""></option>').text(easyreservations_admin_meta_boxes_order.i18n_select_state_text);h=c("<select></select>").prop("id",m).prop("name",l).prop("placeholder",q).addClass("js_field-state select short").append(k);c.each(f,function(e){var s=c("<option></option>").prop("value",e).text(f[e]);if(e===j){s.prop("selected")}h.append(s)});h.val(r);d.replaceWith(h);h.show().selectWoo().hide().change()}else{h=c('<input type="text" />').prop("id",m).prop("name",l).prop("placeholder",q).addClass("js_field-state").val(j);d.replaceWith(h)}c(document.body).trigger("contry-change.easyreservations",[g,c(this).closest("div")]);c(document.body).trigger("country-change.easyreservations",[g,c(this).closest("div")])},change_state:function(){var f=c(this),e=f.val(),d=f.parents("div.edit_address").find(":input.js_field-country"),g=d.val();d.data("easyreservations.stickState-"+g,e)},edit_address:function(j){j.preventDefault();var i=c(this),g=i.closest(".order_data_column"),f=g.find("div.edit_address"),k=g.find("div.address"),h=f.find(".js_field-country"),d=f.find(".js_field-state");k.hide();i.parent().find("a").toggle();if(!h.val()){h.val(easyreservations_admin_meta_boxes_order.default_country).change();d.val(easyreservations_admin_meta_boxes_order.default_state).change()}f.show()},change_customer_user:function(){if(!c("#_billing_country").val()){c("a.edit_address").click();b.load_address(true)}},load_address:function(f){if(true===f||window.confirm(easyreservations_admin_meta_boxes.load_address)){var d=c("#customer_user").val();if(!d){window.alert(easyreservations_admin_meta_boxes.no_customer_selected);return false}var e={user_id:d,action:"easyreservations_get_customer_details",security:easyreservations_admin_meta_boxes.get_customer_details_nonce};c("div.edit_address").block({message:null,overlayCSS:{background:"#fff",opacity:0.6}});c.ajax({url:easyreservations_admin_meta_boxes.ajax_url,data:e,type:"POST",success:function(g){if(g&&g.billing){c.each(g.billing,function(h,i){c(":input#_"+h).val(i).change()})}c("div.edit_address").unblock()}})}return false}};var a={init:function(){c("#easyreservations-order-notes").on("click","button.add_note",this.add_order_note).on("click","a.delete_note",this.delete_order_note)},add_order_note:function(){if(!c("textarea#add_order_note").val()){return}c("#easyreservations-order-notes").block({message:null,overlayCSS:{background:"#fff",opacity:0.6}});var d={action:"easyreservations_add_order_note",post_id:easyreservations_admin_meta_boxes.post_id,note:c("textarea#add_order_note").val(),note_type:c("select#order_note_type").val(),security:easyreservations_admin_meta_boxes.add_order_note_nonce};c.post(easyreservations_admin_meta_boxes.ajax_url,d,function(e){c("ul.order_notes").prepend(e);c("#easyreservations-order-notes").unblock();c("#add_order_note").val("")});return false},delete_order_note:function(){if(window.confirm(easyreservations_admin_meta_boxes.i18n_delete_note)){var d=c(this).closest("li.note");c(d).block({message:null,overlayCSS:{background:"#fff",opacity:0.6}});var e={action:"easyreservations_delete_order_note",note_id:c(d).attr("rel"),security:easyreservations_admin_meta_boxes.delete_order_note_nonce};c.post(easyreservations_admin_meta_boxes.ajax_url,e,function(){c(d).remove()})}return false}};b.init();a.init()});